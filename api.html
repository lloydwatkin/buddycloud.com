<!DOCTYPE html>
<head>
    <title>API</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://new.buddycloud.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://new.buddycloud.com/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://new.buddycloud.com/theme/css/bootstrap-glyphicons.css" rel="stylesheet">
    <link href="http://new.buddycloud.com/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="http://new.buddycloud.com/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="//code.jquery.com/jquery.min.js"></script>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://new.buddycloud.com" class="navbar-brand">buddycloud.com</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li><a href="http://new.buddycloud.com/api">API</a></li>
                        <li><a href="http://new.buddycloud.com/architecture">Architecture</a></li>
                        <li><a href="http://new.buddycloud.com/contact">Contact</a></li>
                        <li><a href="http://new.buddycloud.com/developers">Developers</a></li>
                        <li><a href="http://new.buddycloud.com/features">Features</a></li>
                        <li><a href="http://new.buddycloud.com/test">TEST</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content" class="body">
        <div class="page-header">
		<h1 class="entry-title">API</h1>
	</div>
	<div class="entry-navbar">
		{ API navigation bar linking to sections within the API documentation }
		<ul class="nav nav-pills nav-stacked">
		</ul>
	</div>
	<div class="entry-content">
		<p>__TOC__
Above is the Table of Contents syntax.</p>
<p>The HTTP API is implemented by the <a href="buddycloud%20HTTP%20API%20server" title="wikilink">buddycloud HTTP API
server</a>.</p>
<p>The buddycloud HTTP API presents a simple way to access buddycloud
channels through a REST-like interface. It is thought as an alternative
to buddycloud's <a href="XMPP%20XEP" title="wikilink">XMPP interface</a>.</p>
<h1>General Notes</h1>
<p>HTTPS only
:   All requests should be sent using HTTPS.</p>
<p>UTF-8 encoding
:   Each string passed to and from the buddycloud API must be UTF-8
    encoded. (In the case of JSON set "Content-Type" to
    "application/json; charset=utf-8")</p>
<p>Time format
:   All dates accepted and sent by the API are in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO
    8601</a> format (example:
    "2012-08-21T22:31:20+0000"). In
    <a href="http://pubs.opengroup.org/onlinepubs/007908799/xsh/strftime.html">strftime</a>
    format, this equals the following specification:
    <em>%Y-%m-%dT%H:%M:%SZ</em></p>
<p>Tools for experiments
:   An online-tool which can be helpful for experiments with the API:
    <a href="https://apigee.com/console/others">apigee</a></p>
<h1>Finding the API server</h1>
<p>Since each domain runs their own buddycloud API server, you can use DNS
to discover the API server for a domain.</p>
<p>A DNS lookup for the <code>_buddycloud-api._tcp.example.com</code> <a href="https://en.wikipedia.org/wiki/TXT_record">TXT
record</a> will give you the
server. </p>
<ul class='nav nav-tabs'>
	<li class='active'><a href='#id_dig_command' data-toggle='tab'>dig command</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_dig_command'>
		<p>~~~~ bash
$ dig txt _buddycloud-api._tcp.EXAMPLE.COM</p>
<p>;; ANSWER SECTION:
_buddycloud-api._tcp.EXAMPLE.COM.          IN TXT "v=1.0" "host=buddycloud.EXAMPLE.COM" "protocol=https" "path=/api" "port=443"
~~~~</p>
<p>This tells a client that any API calls for <code>example.com</code> should be made
against <code>https://buddycloud.example.com:443/api</code> </p>
	</div>
</div><h1>Authenticating</h1>
<p>For requests that require authentication, use the <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">HTTP
Basic</a> method.
The username should be a qualified username, like <em>user@example.com</em>.
Note that only users belonging to the API server's "home" domain are
accepted. (You cannot authenticate as <em>somebody@domain1.com</em> at the API
server of <em>domain2.net</em>.)</p>
<h1>Content Types</h1>
<p>A buddycloud channel is essentially a collection of publish subscribe
nodes. Each post is a complete Atom formatted entry.</p>
<p>A <a href="http://www.json.org/">JSON</a>-based format is also available that
includes the most important information present in the Atom feeds. To
retrieve - pass the following request headers:</p>
<p><code>Accept: application/json</code>\
<code>Content-Type: application/json</code></p>
<p>The JSON format represents each channel node item as an object with the
following string attributes:</p>
<p>id:
:   The item's ID.
author
:   The user ID of the item's author.
updated
:   The date/time the entry was posted or last edited, in <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601
    format</a>.
content
:   The entry's text content.
media
:   Custom structured field, with necessary media information for
    fetching and displaying it.
replyTo
:   The ID of the entry that this entry replies to. Only defined for
    comments.</p>
<p>A JSON channel node feed is simply an array of such item objects.</p>
<h1>Permissions</h1>
<h2>Visibility</h2>
<p><em>who can see what?</em></p>
<hr />
<p>Element                                  Example                                producer   moderator   follower+post   follower   anonymous/web   banned
  Channel address                          me@domain.com                          yes        yes         yes             yes        yes             yes
  Channel name                             My little channel                      yes        yes         yes             yes        yes             yes
  Channel description                      A channel about me                     yes        yes         yes             yes        yes             yes
  open channel: mood                       Wishing it was Friday                  yes        yes         yes             yes        yes             yes
  open channel: posts                      Lunch with me?                         yes        yes         yes             yes        yes             yes
  open channel: geoloc                     Next: News cafe                        yes        yes         yes             yes        no              no
  open channel: subscriber list                                                   yes        yes         yes             yes        yes             yes
  open personal channel: outside roles     see what you follow/moderate/produce   yes        yes         yes             yes        yes             yes
  closed channel: geoloc                   Office                                 yes        yes         yes             yes        no              no
  closed channel: posts                    Did she really say that?               yes        yes         yes             yes        no              no
  closed channel: mood                     It's still Thursday                    yes        yes         yes             yes        no              no
  closed channel: subscriber list                                                 yes        yes         yes             yes        no              no
  banned list                                                                     yes        yes         no              no         no              no
  closed personal channel: outside roles   see what you follow/moderate/produce   yes        yes         yes             yes        no              no</p>
<hr />
<h2>Changes</h2>
<p><em>who can change what?</em></p>
<hr />
<pre><code>                                   server operation                                               Example                                           producer   moderator                   follower+post   follower   anonymous/web   banned
</code></pre>
<p>Channel Jid                                                                                         me@domain.com                                     no         no                          no              no         no              no</p>
<p>Channel name                         manage-node-configuration <em>pubsub#title</em>                      My little channel                                 yes        no                          no              no         no              no</p>
<p>Channel description                  manage-node-configuration <em>pubsub#description</em>                A channel about me                                yes        no                          no              no         no              no</p>
<p>mood                                 publish-node-items in <em>status</em> node                            Wishing it was Friday                             yes        no                          no              no         no              no</p>
<p>geoloc                               publish-node-items in <em>geoloc</em> nodes                           News Cafe                                         yes        no                          no              no         no              no</p>
<p>add post                             publish-node-items in <em>posts</em> node                             Lunch with me?                                    yes        yes                         yes             no         no              no</p>
<p>remove post                          retract-node-items (in <em>posts</em> node)                                                                             yes        yes                         no              no         no              no</p>
<p>approve new followers                manage-node-configuration <em>buddycloud#approve_followers</em>     new followers must be approved <em>yes</em> or <em>no</em>      yes        -   personal channels: no   no              no         no              no
                                                                                                                                                                   -   topic channels: yes                                                </p>
<p>set default role for new followers   manage-node-configuration <em>buddycloud#default_affiliation</em>   new followers are <em>follower</em> or <em>follower+post</em>   yes        no                          no              no         no              no</p>
<p>channel privacy                      manage-node-configuration <em>pubsub#access_model</em>              toggle open / closed channel                      yes        no                          no              no         no              no</p>
<p>change role of a follower            manage-node-affiliations                                                                                         yes        yes                         no              no         no              no</p>
<p>make moderator                       manage-node-affiliations                                                                                         yes        no                          no              no         no              no</p>
<hr />
<h1>API Endpoints</h1>
<h2>/:channel/content/:node</h2>
<p>Description
:   Receives or posts to a channel node, which represents a stream of
    channel content. Every channel has at least a <strong>posts</strong> node, which
    holds all posts published in the channel. Other types of channel
    nodes such as <em>geoloc</em> (location information) and <em>status</em> will be
    added in the future.</p>
<p>Content Types
:   Atom <em>(application/atom+xml)</em>
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves a channel node's content as Atom feed.
:   <strong>POST</strong> - Adds an Atom entry to the node. The created item's URL is
    returned in the response's <em>Location</em> header.</p>
<p>Parameters
:   <strong>max</strong> <em>(optional)</em> - The maximum number of returned entries. Only
    allowed for GET.
:   <strong>after</strong> <em>(optional)</em> - Return only entries older than the entry
    with the specified ID. Only allowed for GET.</p>
<p>Responses
:   <strong>200 OK</strong> if GET succeeds.
:   <strong>201 Created</strong> if POST succeeds.
:   <strong>400 Bad Request</strong> if an invalid Atom entry is posted.
:   <strong>401 Unauthorized</strong> if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> if the user is not permitted to view or post to
    the channel node (e.g. if the channel is private).
:   <strong>404 Not Found</strong> if the specified channel or node does not exist.</p>
<p>Post Threading
:   For items representing comments, the corresponding Atom entries
    include a <code>replyTo</code> (JSON) or <code>&lt;in-reply-to/&gt;</code> (XML) element as
    specified in the <a href="http://www.ietf.org/rfc/rfc4685.txt">Atom Threading
    Extensions</a></p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json' data-toggle='tab'>JSON</a></li>
	<li><a href='#id_xml' data-toggle='tab'>XML</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json'>
		uses <code>replyTo</code>. For example:</p>
<p>~~~~ javascript
      { "author" : "alice@example.com",
        "content" : "Ok",
        "id" : "17163726-ea90-453e-ad25-455336a83fd4",
        "media": null,
        "published" : "2012-11-02T03:41:55.484Z",
        "replyTo" : "9b7724d0-7ef5-4331-8974-81754abb7ba0",
        "updated" : "2012-11-02T03:41:55.484Z"
      }
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_xml'>
		<p>~~~~ xml
<entry xmlns="http://www.w3.org/2005/Atom"></p>
<p><!-- This entry is a comment on the post with ID "original-post" -->
  <in-reply-to xmlns="http://purl.org/syndication/thread/1.0" ref="original-post"/>
</entry>
~~~~</p>
	</div>
</div><p>Notes
:   When posting an item, the item's ID and author don't need to be
    specified as they are filled in by the channel server.
:   (Observation on 2012-12-09: When only the item's content is
    specified, then published and updated are set to null. That is not
    necessarily how it should be. In such a case the server could set
    published to the current date and time.)
:   To make the item a comment, use the <code>replyTo</code> attribute for JSON or
    the <code>&lt;in-reply-to/&gt;</code> element (for Atom).</p>
<p>Examples</p>
<ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
	<li><a href='#id_xml' data-toggle='tab'>XML</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		<p>~~~~ bash
GET /alice@examle.com/content/posts
Accept: application/json
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>[
  {
    "id": "foo",
    "author": "alice@example.com",
    "updated": "2012-06-01T12:00:00Z",
    "content": "This is my newest post!",
    "media": null
  },
  {
    "id": "bar",
    "author": "alice@example.com",
    "updated": "2012-05-31T12:00:00Z",
    "content": "June starts tomorrow.",
    "media": null
  },
  {
    "id": "baz",
    "author": "alice@example.com",
    "updated": "2012-05-30T12:00:00Z",
    "content": "Feeling good today!",
    "media": [{"id": "qwe", "channel": "alice@example.com"}]
  }
]
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>~~~~ javascript
POST /bob@example.com/content/posts
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/json</p>
<p>{
  "content": "Hello JSON!"
}
~~~~</p>
<p>~~~~ xml
201 Created
Location: http://api.example.com/bob@example.com/content/posts/bipp
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_xml'>
		<p>Retrieve all posts from "alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/content/posts
~~~~</p>
<p>~~~~ xml
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alice's posts</title>
  <entry>
    <id>foo</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-06-01T12:00:00Z</published>
    <content>This is my newest post!</content>
  </entry>
  <entry>
    <id>bar</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-05-31T12:00:00Z</published>
    <content>June starts tomorrow.</content>
  </entry>
  <entry>
    <id>baz</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-05-30T12:00:00Z</published>
    <content>Feeling good today!</content>
    <media>
       <item id="qwe" channel="alice@example.com"/>
    </media>
  </entry>
</feed>
~~~~</p>
<p>Retrieve the newest post from "alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/content/posts?max=1
~~~~</p>
<p>~~~~ xml
200 OK
Content-Type: application/atom+xml</p>
<p><feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alice's posts</title>
  <entry>
    <id>foo</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-06-01T12:00:00Z</published>
    <content>This is my newest post!</content>
  </entry>
</feed>
~~~~</p>
<p>Get the two newest posts that are older than the one retrieved above:</p>
<p>~~~~ bash
GET /alice@example.com/content/posts?max=2&amp;after=foo
~~~~</p>
<p>~~~~ xml
200 OK
Content-Type: application/atom+xml</p>
<p><feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alice's posts</title>
  <entry>
    <id>bar</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-05-31T12:00:00Z</published>
    <content>June starts tomorrow.</content>
  </entry>
  <entry>
    <id>baz</id>
    <author>
      <name>alice@example.com</name> 
      <id>acct:alice@example.com</id>
    </author>
    <published>2012-05-30T12:00:00Z</published>
    <content>Feeling good today!</content>
  </entry>
</feed>
~~~~</p>
<p>Add a post to "bob@example.com":</p>
<p>~~~~ xml
POST /bob@example.com/content/posts
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/atom+xml</p>
<p><entry xmlns="http://www.w3.org/2005/Atom">
  <content>Hello World!</content>
</entry>
~~~~</p>
<p>~~~~ xml
201 Created
Location: http://api.example.com/channels/bob@example.com/posts/item?id=buux
~~~~</p>
<p>Comment on the newest post of "alice@example.com":</p>
<p>~~~~ xml
POST /alice@example.com/content/posts
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/atom+xml</p>
<p><entry xmlns="http://www.w3.org/2005/Atom">
  <in-reply-to ref="foo" xmlns="http://purl.org/syndication/thread/1.0"/>
  <content>And this is my newest comment ;)</content>
</entry>
~~~~</p>
<p>~~~~ xml
201 Created
Location: http://api.example.com/alice@example.com/content/posts/fooboo
~~~~</p>
	</div>
</div><h2>/:channel/content/:item/</h2>
<p>Description
:   Allows access to single items (e.g., posts) of a channel node. Both
    Atom and JSON representations are available (see <a href="#Channel_Content_Formats" title="wikilink">#Channel Content
    Formats</a>).</p>
<p>Content Types
:   Atom <em>(application/atom+xml)</em>
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves an item of a channel node.
:   <strong>PUT</strong> <em>(not implemented)</em> - Replaces an item with the Atom entry
    specified in the request body.
:   <strong>DELETE</strong> - Deletes an item.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>400 Bad Request</strong> if a PUT request contains an invalid Atom entry.
:   <strong>401 Unauthorized</strong> if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> if the user is not permitted to view or edit the
    item.
:   <strong>404 Not Found</strong> if the specified channel, node or item does not
    exist.</p>
<p>Notes
:   A channel node item may only be modified by the user who published
    it, and removed only by its publisher or the channel's owner.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_xml_get' data-toggle='tab'>XML GET</a></li>
	<li><a href='#id_delete' data-toggle='tab'>DELETE</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieve a post</p>
<p>~~~~ bash
GET /alice@example.com/content/posts/baz
Accept: application/json
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "id": "baz",
  "author": "alice@example.com",
  "updated": "2012-05-30T12:00:00Z",
  "content": "Feeling good today!"
  "media": [{"id": "qwe", "channel": "alice@example.com"}]
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_xml_get'>
		<p>Retrieve the post with ID "baz" of "alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/content/posts/baz
~~~~</p>
<p>~~~~ xml
200 OK
Content-Type: application/atom+xml</p>
<p><entry xmlns="http://www.w3.org/2005/Atom">
  <id>baz</id>
  <author>
    <name>alice@example.com</name> 
    <id>acct:alice@example.com</id>
  </author>
  <published>2012-05-30T12:00:00Z</published>
  <content>Feeling good today!</content>
  <media>
    <item id="qwe" channel="alice@example.com"/>
  </media>
</entry>
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_delete'>
		<p>Deletes the post with ID "baz" of "alice@example.com":</p>
<p>~~~~ bash
DELETE /alice@example.com/content/posts/baz
~~~~</p>
<p>~~~~ xml
204 OK
No Content
~~~~</p>
	</div>
</div><h2>/:channel/metadata/:node</h2>
<p>Description
:   Gets or sets metadata about a channel node.</p>
<p>Attributes
:   <em>title</em> - The channel node's title.
:   <em>description</em> - A short string describing the node.
:   <em>creation_date</em> - The date the node was created in
    <a href="http://www.ietf.org/rfc/rfc3339.txt">RFC339</a> format.
:   <em>access_model</em> - Whether the node is public ("open") or private
    ("authorize").
:   <em>channel_type</em> - The type of the containing channel ("personal" or
    "topic").
:   <em>default_affiliation</em> - New users default affiliation ("publisher"
    or "follower").</p>
<p>Content Type
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves values in the channel node's metadata.
:   <strong>POST</strong> - Updates values in the channel node's metadata.</p>
<p>Parameters
:   (none)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> if the user is not permitted to access the channel
    node.
:   <strong>404 Not Found</strong> if the specified channel or node does not exist.</p>
<p>Notes
:   The title and description of the channel's <em>posts</em> node define the
    respective attributes of the channel itself.</p>
<p>Example</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json' data-toggle='tab'>JSON</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json'>
		Retrieve the metadata of the "posts" node of
"alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/metadata/posts
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "title": "Alice's Posts",
  "description": "Everything about Alice",
  "creation_date": "2012-05-30",
  "access_model": "whitelist",
  "channel_type": "personal",
  "default_affiliation": "publisher" 
}
~~~~</p>
	</div>
</div><h2>/:channel/subscribers/:node</h2>
<p>Description
:   Can be used to get a channel node's subscribers or to change the
    affiliation of a channel node's subscribers.</p>
<p>Content Type
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the list of subscribers as JSON object. The
    object's keys are the subscriber's usernames, the values are their
    member types ("owner", "publisher" or "member").
:   <strong>POST</strong> - Changes the affiliation of the channel node's
    subscribers. The body must be a JSON object with exactly one
    key-value pair of the form returned by GET. The new valid member
    type values provided will be assigned to each existing subscriber.
    Only the channel onwer and moderators of the channel are allowed to
    perform this operation. Only the channel onwer can assign followers
    the member type "moderator" (thus promoting them to moderators) or
    change affiliation roles of moderators.</p>
<p>Parameters
:   (none)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if the request is not authenticated.
:   <strong>403 Forbidden</strong> if the user is not permitted to access the channel
    node or perform the affiliation change operation.
:   <strong>404 Not Found</strong> if the specified channel or node does not exist.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieve the subscribers of the "posts" node of
"alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/subscribers/posts
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "alice@example.com": "owner",
  "bob@example.com": "publisher"
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>Change the affiliation role of "bob@example.com" (who
follows the "posts" node of "alice@example.com") to "member":</p>
<p>~~~~ bash
POST /alice@example.com/subscribers/posts
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/json</p>
<p>{"bob@example.com": "member"}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
<p>The affiliation role of "bob@example.com" should be updated:</p>
<p>~~~~ bash
GET /alice@example.com/subscribers/posts
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "alice@example.com": "owner",
  "bob@example.com": "member"
}
~~~~</p>
	</div>
</div><h2>/:channel/subscribers/:node/approve</h2>
<p>Description
:   Lists and modifies the state of subscriptions in a node. Should be
    used in order to list, approve or deny pending subscription
    requests.</p>
<p>Content Type
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the list of subscriptions of a node. Returns a
    list of objects containing the subscriber JID and the values of its
    subscription state ("subscribed" or "pending").
:   <strong>POST</strong> - Changes the subscription state of subscribers. Possible
    states are: "subscribed", in order to approve a pending request; or
    "none", in order to deny it.</p>
<p>Parameters
:   (none)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if the request is not authenticated.
:   <strong>403 Forbidden</strong> if the user is not permitted to access the channel
    node or perform the subscription change operation.
:   <strong>404 Not Found</strong> if the specified channel or node does not exist.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieve subscription states of the "posts" node of
"alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/subscribers/posts/approve
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>[
  {"subscription": "subscribed", "jid": "doe@example.com"},
  {"subscription": "pending", "jid": "bob@example.com"},
  {"subscription": "pending", "jid": "john@example.com"}
]
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>Approves the request from "bob@example.com" and denies
the one from "john@example.com":</p>
<p>~~~~ bash
POST /alice@example.com/subscribers/posts/approve
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/json</p>
<p>[
  {"subscription": "subscribed", "jid": "bob@example.com"},
  {"subscription": "none", "jid": "john@example.com"}
]
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/:channel/media</h2>
<p>Description
:   Uploads media to a channel or lists the media in a channel</p>
<p>Methods
:   <strong>GET</strong> - Gets all media metadata information from the specified
    channel.
:   <strong>POST</strong> - Uploads a media file to the specified channel.</p>
<p>Content-Type (POST)
:   <em>application/x-www-form-urlencoded</em>
:   <em>multipart/form-data</em></p>
<p>Arguments (POST)
:   <strong><em>data</em></strong> - the media to upload
:   <strong><em>content-type</em></strong> - the media content-type
:   <strong><em>filename*<em> (optional)</em> - the media original filename
:   </em></strong>title<strong> (optional)* - the title of the media
:   </strong><em>description</em><em> (optional)</em> - a description of the media</p>
<p>Parameters
:   <strong><em>max*<em> (optional)</em> - maximum number of returned metadata. Only
    allowed for GET.
:   </em></strong>after*<em> (optional)</em> - only metadata older than the entry with the
    specified ID. Only allowed for GET.</p>
<p>Responses
:   <strong>200 OK</strong> - if get succeeds, including the media metadata.
:   <strong>201 Created</strong> - if post succeeds, including the successfully
    uploaded media metadata.
:   <strong>400 Bad Request</strong> - if the client not provide proper
    authentication fields.
:   <strong>401 Unauthorized</strong> - if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> - if the user is not permitted to get or post to
    the channel (e.g. if the channel is private).</p>
<p>Media Metadata
:   <strong>height</strong> <em>server-set</em> height of the uploaded image or video. This
    is calculated by the server and not editable.
:   <strong>width</strong> <em>server-set</em> width of the uploaded image or video. This is
    calculated by the server and not editable.
:   <strong>author</strong> <em>required</em> the buddycloudID of the author
:   <strong>entityId</strong> <em>required</em> the buddycloudID of the channel or user that
    owns the media
:   <strong>shaChecksum</strong> <em>required</em> SHA1 file checksum
:   <strong>mimeType</strong> <em>required</em> mimetype
:   <strong>fileName</strong> <em>required</em> the uploaded filename (including extension)
:   <strong>uploadedDate</strong> <em>required</em> when the media was uploaded
:   <strong>lastUpdatedDate</strong> <em>required</em> last time this media was updated
:   <strong>title</strong> <em>optional</em> media title
:   <strong>description</strong> <em>optional</em> media description</p>
<p>Notes
:   GET operations for public channels don't need authentication.</p>
<p>Examples</p>
<ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		<p>:   retrieve a list of all media in a channel together with metadata</p>
<p>~~~~ bash
GET https://api.example.com/channel@topics.domain.com/media
~~~~</p>
<p>:   response, if everything went ok</p>
<p>~~~~ javascript
// 200 response
{{
  "id":"lETuJi8rPE4IfQrygN6rVtGx3",
  "fileName":"testimage.jpg",
  "author":"alice@domain.com",
  "title":"Test Image",
  "mimeType":"image/jpeg",
  "description":"My Test Image",
  "fileExtension":"jpg",
  "shaChecksum":"bc46e5fac2f1cbb607c8b253a5af33181f161562",
  "fileSize":60892,
  "height":312,
  "width":312,
  "entityId":"channel@topics.domain.com"
 },
 ...
 {
  "id":"QrygN6rlETufVtGx3Ji8rPE4I",
  "fileName":"summer.avi",
  "author":"alice@domain.com",
  "title":"Summer 2012",
  "mimeType":"video/avi",
  "description":"Summer video",
  "fileExtension":"avi",
  "shaChecksum":"c2f1cbb6bc46e5fa07c8b251615623a5af33181f",
  "fileSize":120988,
  "height":640,
  "width":480,
  "entityId":"channel@topics.domain.com"
 }}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>upload a new item to <strong>channel@topics.domain.com</strong></p>
<p>~~~~ javascript
POST {"filename": "testimage.jpg", 
      "title": "Test Image", 
      "description": "My test image", 
      "content-type": "image/jpeg", 
      "data": image} 
      https://api.example.com/channel@topics.domain.com/media
~~~~</p>
<p>:   response</p>
<p>~~~~ javascript
// 201 response
{
  "id":"lETuJi8rPE4IfQrygN6rVtGx3",
  "fileName":"testimage.jpg",
  "author":"alice@domain.com",
  "title":"Test Image",
  "mimeType":"image/jpeg",
  "description":"My Test Image",
  "fileExtension":"jpg",
  "shaChecksum":"bc46e5fac2f1cbb607c8b253a5af33181f161562",
  "fileSize":60892,
  "height":312,
  "width":312,
  "entityId":"channel@topics.domain.com"
}
~~~~</p>
	</div>
</div><h2>/:channel/media/:media</h2>
<p>Description
:   Updates metadata, deletes or gets a channel media.</p>
<p>Methods
:   <strong>POST</strong> - Updates the metadata of the specified media.
:   <strong>GET</strong> - Gets the specified media file.
:   <strong>DELETE</strong> - Deletes the specified media.</p>
<p>Content-Type (POST)
:   <em>application/x-www-form-urlencoded</em></p>
<p>Arguments (POST)
:   <strong><em>filename*<em> (optional)</em> - the new media filename
:   </em></strong>title<strong> (optional)* - the new title of the media
:   </strong><em>description</em><em> (optional)</em> - a new description for the media</p>
<p>Parameters
:   <strong>maxheight</strong> (optional) - if the media can be previewed (image or
    video), returns a thumbnail bounded by the specified height. (GET
    only)
:   <strong>maxwidth</strong> (optional) - if the media can be previewed (image or
    video), returns a thumbnail bounded by specified width. (GET only)</p>
<p>Responses
:   <strong>200 OK</strong> - if get or post succeeds, including the media file or
    the media metadata.
:   <strong>400 Bad Request</strong> - if the client not provide proper
    authentication fields.
:   <strong>401 Unauthorized</strong> - if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> - if the user is not permitted to update, get or
    delete the media (e.g. if the user is not a private channel's owner
    or moderator).
:   <strong>404 Not Found</strong> - there is no media with such id.
:   <strong>412 Precondition Failed</strong> - if the client requests a thumbnail of
    a media with a not valid format (different from image or video).</p>
<p>Notes
:   GET operations for public channels don't need authentication.
:   DELETE removes all media's information, including thumbnails and
    metadata.</p>
<p>Examples</p>
<ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
	<li><a href='#id_json_delete' data-toggle='tab'>JSON DELETE</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		<p>:   Get media</p>
<p>~~~~ bash
GET https://api.example.com/channel@topics.domain.com/media/lETuJi8rPE4IfQrygN6rVtGx3?maxwidth=640
~~~~</p>
<p>~~~~ javascript
// 200 response with the media content
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>:   update the media information</p>
<p>~~~~ javascript
POST {"filename": "newname.jpg", 
      "title": "New Title", 
      "description": "New description", 
      https://api.example.com/channel@topics.domain.com/media/lETuJi8rPE4IfQrygN6rVtGx3
~~~~</p>
<p>:   response, if everything went ok</p>
<p>~~~~ javascript
// 200 response
{
  "id":"lETuJi8rPE4IfQrygN6rVtGx3",
  "fileName":"newname.jpg",
  "author":"alice@domain.com",
  "title":"New Title",
  "mimeType":"image/jpeg",
  "description":"New description",
  "fileExtension":"jpg",
  "shaChecksum":"bc46e5fac2f1cbb607c8b253a5af33181f161562",
  "fileSize":60892,
  "height":312,
  "width":312,
  "entityId":"channel@topics.domain.com"
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_delete'>
		<p>:   Delete the media</p>
<p>~~~~ bash
DELETE https://api.example.com/channel@topics.domain.com/media/lETuJi8rPE4IfQrygN6rVtGx3
~~~~</p>
<p>~~~~ javascript
// 200 response
~~~~</p>
	</div>
</div><h2>/:channel/media/avatar</h2>
<p>Description
:   Special endpoint that handles channel's avatars: uploads, updates,
    deletes or gets a channel avatar.</p>
<p>Methods
:   <strong>PUT</strong> - Uploads an image to be the avatar of the specified
    channel. If there is a previous one, it is replaced.
:   <strong>POST</strong> - Updates the avatar <em>metadata</em>.
:   <strong>GET</strong> - Gets the avatar from the specified channel.
:   <strong>DELETE</strong> - Deletes the avatar from the specified channel.</p>
<p>Content-Type (PUT)
:   <em>application/x-www-form-urlencoded</em>
:   <em>multipart/form-data</em></p>
<p>Arguments (PUT)
:   <strong><em>data</em></strong> - the avatar to upload
:   <strong><em>content-type</em></strong> - the avatar content-type
:   <strong><em>filename*<em> (optional)</em> - the avatar original filename
:   </em></strong>title<strong> (optional)* - the title of the avatar
:   </strong><em>description</em><em> (optional)</em> - a description of the avatar</p>
<p>Arguments (POST)
:   <strong><em>filename*<em> (optional)</em> - the avatar new filename
:   </em></strong>title<strong> (optional)* - the new title of the avatar
:   </strong><em>description</em><em> (optional)</em> - a new description for the avatar</p>
<p>Parameters
:   <strong>maxheight</strong> (optional) - returns an avatar thumbnail that fits the
    specified height. Only allowed for GET.
:   <strong>maxwidth</strong> (optional) - returns an avatar thumbnail that fits the
    specified width. Only allowed for GET.</p>
<p>Responses
:   <strong>200 OK</strong> - if get succeeds, including the avatar file.
:   <strong>201 Created</strong> - if put succeeds, including the successfully
    uploaded avatar metadata.
:   <strong>400 Bad Request</strong> - if the client not provide proper
    authentication fields.
:   <strong>401 Unauthorized</strong> - if authentication is required, but not
    provided.
:   <strong>403 Forbidden</strong> - if the user is not permitted to put or delete
    the channel's avatar (e.g. if the user is not the channel's owner or
    moderator).
:   <strong>404 Not Found</strong> - there is no avatar set to the specified channel.</p>
<p>Note
:   All avatars are public, that means that the GET operation doesn't
    need authentication.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_put' data-toggle='tab'>JSON PUT</a></li>
	<li><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_delete' data-toggle='tab'>JSON DELETE</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_put'>
		upload a new avatar</p>
<p>~~~~ javascript
PUT {"filename": "avatar.jpg", 
      "title": "My New Avatar", 
      "description": "My brand new avatar", 
      "content-type": "image/jpeg", 
      "data": image} 
      https://api.example.com/alice@domain.com/media/avatar
~~~~</p>
<p>:   response, if everything went ok</p>
<p>~~~~ javascript
// 201 response
{
  "id":"lETuJi8rPE4IfQrygN6rVtGx3",
  "fileName":"avatar.jpg",
  "author":"alice@domain.com",
  "title":"My New Avatar",
  "mimeType":"image/jpeg",
  "description":"My brand new avatar",
  "fileExtension":"jpg",
  "shaChecksum":"bc46e5fac2f1cbb607c8b253a5af33181f161562",
  "fileSize":60892,
  "height":312,
  "width":312,
  "entityId":"alice@domain.com"
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_get'>
		<p>:   Visualize Alice's new avatar</p>
<p>~~~~ bash
GET https://api.example.com/alice@domain.com/media/avatar
~~~~</p>
<p>~~~~ javascript
// 200 response with the picture content
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_delete'>
		<p>Delete the avatar</p>
<p>~~~~ bash
DELETE https://api.example.com/alice@domain.com/media/avatar
~~~~</p>
<p>~~~~ javascript
// 200 response
~~~~</p>
	</div>
</div><h2>/:channel</h2>
<p>Description
:   Used to create a topic channel.</p>
<p>Methods
:   <strong>POST</strong> - Creates a topic channel with default configuration.</p>
<p>Parameters
:   (none)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is not provided.
:   <strong>403 Forbidden</strong> if the user is not allowed to create a channel.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_post' data-toggle='tab'>POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_post'>
		Crates the topic channel
"talesofalice@topics.example.com":</p>
<p>~~~~ bash
POST /talesofalice@topics.example.com
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/:channel/similar</h2>
<p>Description
:   Retrieves similar channels to a given channel based on the social
    graph indexed by the <a href="Channel%20Directory%20Project" title="wikilink">Channel
    Directory</a>.</p>
<p>Content Type
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the list of similar channels of a given channel.</p>
<p>Parameters
:   <strong><em>max</em></strong> (optional) - the maximum number of items to be returned.
:   <strong><em>index</em></strong> (optional) - the index for the first item to be
    returned.</p>
<p>Responses
:   <strong>200 OK</strong> on success.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_get' data-toggle='tab'>GET</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_get'>
		Retrieve similar channels to node "alice@example.com":</p>
<p>~~~~ bash
GET /alice@example.com/similar
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "items" : [ { "channelType" : "topic",
        "creationDate" : "2012-04-24T09:13:51+0000",
        "defaultAffiliation" : "publisher",
        "description" : "/dev/hack",
        "jid" : "team@topics.buddycloud.org",
        "title" : "buddycloud dev team"
      },
      { "channelType" : "personal",
        "creationDate" : "2012-02-05T13:31:12+0000",
        "defaultAffiliation" : "publisher",
        "description" : "Everything about Bob.",
        "jid" : "bob@example.com",
        "title" : "Bob's Posts"
      }
    ],
  "rsm" : { "count" : "2",
      "index" : "0"
    }
}
~~~~</p>
	</div>
</div><h2>/subscribed</h2>
<p>Description
:   Returns the user's subscriptions.</p>
<p>Content Type
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the list of subscribed-to channels as a JSON
    object. The object's keys are of the form "<channel>/<node>", the
    values denote the subscription type ("owner", "publisher", "member"
    or "pending").
:   <strong>POST</strong> - Subscribes to or unsubscribes from a node. The body must
    be a JSON object with exactly one key-value pair of the form
    returned by GET. The node will be subscribed to if the value is
    "publisher" or "member", while "none" means unsubscription.</p>
<p>Parameters
:   (none)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if the request is not authenticated.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieve the own subscribed-to channel nodes as
"alice@example.com":</p>
<p>~~~~ bash
GET /subscribed
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "alice@example.com/posts": "owner",
  "bob@example.com/posts": "publisher",
  "public@topics.example.com/posts": "publisher"
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>Subscribe to "bob@example.com":</p>
<p>~~~~ bash
POST /subscribed
Authorization: Basic Ym9iQGV4YW1wbGUuY29tOmJvYg==
Content-Type: application/json</p>
<p>{"bob@example.com/posts": "publisher"}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/sync</h2>
<p>Description
:   Allows access to the latest posts of all channel nodes a user
    subscribes to. Only JSON representation is available for this query
    (see <a href="#Channel_Content_Formats" title="wikilink">#Channel Content
    Formats</a>).</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the latests items of all channel nodes an user
    subcribes to.</p>
<p>Arguments (GET)
:   <strong><em>since</em></strong> - is used to filter out messages before a certain
    date/time.
:   <strong><em>max</em></strong> - the maximum number of posts to be returned per channel.
:   <strong><em>summary</em></strong> - (optional) if true, returns only a summary
    information per channel.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is not provided.</p>
<p>Notes
:   The since argument must be given in the ISO 8601, following the
    given format: CCYY-MM-DDThh:mm:ssT. Eg.: 2012-11-01T00:00:00Z</p>
<p>Examples</p>
<ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_get_with_summary' data-toggle='tab'>JSON GET with summary</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		<ul>
<li>retrieve <strong>all</strong> channel posts since: <code>2012-11-01T00:00:00Z</code></li>
<li>but not more than <code>2</code> per channel</li>
</ul>
<p>~~~~ bash
GET /sync?since=2012-11-01T00:00:00Z&amp;max=2
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "/user/bob@example.com/posts" : [ { "author" : "bob@example.com",
        "content" : "Nice post.",
        "id" : "a8eb0384-b504-4aab-9b51-6174a7f9efe7",
        "published" : "2012-11-01T20:06:01.787Z",
        "replyTo" : "08795523-b719-4329-b334-3ee1667aa9c3",
        "updated" : "2012-11-01T20:06:01.787Z"
      } ],
  "/user/alice@example.com/posts" : [ { "author" : "bob@example",
        "content" : "Is it a nice post?",
        "id" : "209aceda-32ef-4754-9746-c1dbc5716359",
        "published" : "2012-11-02T03:42:28.510Z",
        "updated" : "2012-11-02T03:42:28.510Z"
      },
      { "author" : "alice@example.com",
        "content" : "Ok",
        "id" : "17163726-ea90-453e-ad25-455336a83fd4",
        "published" : "2012-11-02T03:41:55.484Z",
        "replyTo" : "9b7724d0-7ef5-4331-8974-81754abb7ba0",
        "updated" : "2012-11-02T03:41:55.484Z"
      }
    ]
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_get_with_summary'>
		<p>true=</p>
<ul>
<li>retrieve <strong>all</strong> post counters since: <code>2012-11-01T00:00:00Z</code></li>
</ul>
<p>~~~~ bash
GET /sync?since=2012-11-01T00:00:00Z&amp;summary=true&amp;max=1000
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "/user/bob@example.com/posts" : {
    "mentionsCount": 2,
    "totalCount": 121,
    "repliesCount": 34,
    "postsThisWeek": [
      "2013-11-08T19:33:33.103Z",
      "2013-11-06T12:12:34.986Z",
      "2013-11-05T23:45:31.609Z",
      "2013-11-05T14:42:30.625Z",
      "2013-11-05T14:34:43.580Z",
      "2013-11-05T14:20:49.844Z",
      "2013-11-03T19:27:16.048Z",
      "2013-11-03T18:46:54.726Z"
    ]
  },
  "/user/alice@example.com/posts" : {
    "mentionsCount": 1,
    "totalCount": 2,
    "repliesCount": 0,
    "postsThisWeek": []
  }
}
~~~~</p>
	</div>
</div><h2>/notification_settings</h2>
<p>Description
:   Allows retrieval and modification on the user's notification
    settings.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the user's notification settings.
:   <strong>POST</strong> - Updates the user's notification settings.
:   <strong>DELETE</strong> - Deletes user's notification settings.</p>
<p>Parameters
:   <strong>type</strong> - Type of notification transport (email, gcm)
:   <strong>target (optional)</strong> - Target address (email address, gcm registration id)</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is not provided.</p>
<p>Notes
:   During a POST, any notification setting can be omitted. Thus, the
    setting will only be updated when provided.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
	<li><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
	<li><a href='#id_json_delete' data-toggle='tab'>JSON DELETE</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieves notification settings:</p>
<p>~~~~ bash
GET /notification_settings?type=email&amp;target=mail@alice.com
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>[{
  "target": "mail@alice.com",
  "postAfterMe": "true",
  "postMentionedMe": "true",
  "postOnMyChannel": "true",
  "postOnSubscribedChannel": "false",
  "followMyChannel ": "true",
  "followRequest": "true"
}]
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_post'>
		<p>Updates notification settings:</p>
<p>~~~~ bash
POST /notification_settings
Content-Type: application/json</p>
<p>{
  "type": "email",
  "target": "mail@alice.com",
  "postAfterMe": "true",
  "postMentionedMe": "true",
  "postOnMyChannel": "true",
  "postOnSubscribedChannel": "false",
  "followMyChannel ": "false",
  "followRequest": "false"
}
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{
  "target": "mail@alice.com",
  "postAfterMe": "true",
  "postMentionedMe": "true",
  "postOnMyChannel": "true",
  "postOnSubscribedChannel": "false",
  "followMyChannel ": "false",
  "followRequest": "false"
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_delete'>
		<p>Deletes notification settings:</p>
<p>~~~~ bash
DELETE /notification_settings
Content-Type: application/json</p>
<p>{
  "type": "email",
  "target": "mail@alice.com",
}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/search</h2>
<p>Description
:   Performs a search over channels' metadata and posts' content indexed
    by the <a href="Channel%20Directory%20Project" title="wikilink">Channel Directory</a>.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Performs a search query to the channel directory. It can
    be performed over posts(type=content) or channels(type=metadata).</p>
<p>Arguments (GET)
:   <strong><em>type</em></strong> - <strong>metadata</strong> or <strong>content</strong>.
:   <strong><em>q</em></strong> - the search criteria.
:   <strong><em>max</em></strong> (optional) - the maximum number of items to be returned.
:   <strong><em>index</em></strong> (optional) - the index for the first item to be
    returned.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>400 Bad Request</strong> - if the client does not provide the mandatory
    fields.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get_for_metadata' data-toggle='tab'>JSON GET for metadata</a></li>
	<li><a href='#id_json_get_for_content' data-toggle='tab'>JSON GET for content</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get_for_metadata'>
		Retrieve channels that have the keyword
<strong>hack</strong> in their metadata:</p>
<p>~~~~ bash
GET /search?type=metadata&amp;q=hack
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{"items":
  [{"jid":"team@topics.buddycloud.org",
    "description":"/dev/hack",
    "creationDate":"2012-04-24T09:13:51+0000",
    "title":"buddycloud dev team",
    "channelType":"topic",
    "defaultAffiliation":"publisher"}
  ],
 "rsm":
  {"index":"0","count":"1"}
}
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_json_get_for_content'>
		<p>Retrieve posts that have the keyword <strong>hack</strong>
in their content:</p>
<p>~~~~ bash
GET /search?type=content&amp;q=hack
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "items" : [ { "author" : "jayteeuk@wyrddreams.org",
        "content" : "Hacking in the evening of Online Services Sprint, Day One.",
        "id" : "1c6cf8b1-cfad-41fb-864a-73accf614484",
        "in_reply_to" : null,
        "parent_fullid" : "/user/jayteeuk@wyrddreams.org/posts",
        "parent_simpleid" : "jayteeuk@wyrddreams.org",
        "published" : "2012-11-12T21:53:49+0000",
        "updated" : "2012-11-12T21:53:49+0000"
      },
      { "author" : "tester1234@buddycloud.org",
        "content" : "hack hack",
        "id" : "d3cd8bc5-5722-42cd-9b95-1313fbe6644b",
        "in_reply_to" : null,
        "parent_fullid" : "/user/tester1234@buddycloud.org/posts",
        "parent_simpleid" : "tester1234@buddycloud.org",
        "published" : "2012-09-25T23:58:00+0000",
        "updated" : "2012-09-25T23:58:00+0000"
      }
    ],
  "rsm" : { "count" : "2",
      "index" : "0"
    }
}
~~~~</p>
	</div>
</div><h2>/recommendations</h2>
<p>Description
:   Recommends channels for a given user based on taste data indexed by
    the <a href="Channel%20Directory%20Project" title="wikilink">Channel Directory</a>.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves channels recommendations for a given user.</p>
<p>Arguments (GET)
:   <strong><em>user</em></strong> - the jid of the user to be recommended.
:   <strong><em>max</em></strong> (optional) - the maximum number of items to be returned.
:   <strong><em>index</em></strong> (optional) - the index for the first item to be
    returned.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>400 Bad Request</strong> - if the client does not provide the mandatory
    fields.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Recommend channels for user <strong>alice@example.com</strong>:</p>
<p>~~~~ bash
GET /recommendations?user=alice@example.com
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "items" : [ { "channelType" : "topic",
        "creationDate" : "2012-04-24T09:13:51+0000",
        "defaultAffiliation" : "publisher",
        "description" : "/dev/hack",
        "jid" : "team@topics.buddycloud.org",
        "title" : "buddycloud dev team"
      },
      { "channelType" : "personal",
        "creationDate" : "2012-02-05T13:31:12+0000",
        "defaultAffiliation" : "publisher",
        "description" : "Everything about Bob.",
        "jid" : "bob@example.com",
        "title" : "Bob's Posts"
      }
    ],
  "rsm" : { "count" : "2",
      "index" : "0"
    }
}
~~~~</p>
	</div>
</div><h2>/most_active</h2>
<p>Description
:   Retrieves the most active channels among the channels indexed by the
    <a href="Channel%20Directory%20Project" title="wikilink">Channel Directory</a>. The most
    active channels are the ones that had more posts in the window of a
    day.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>GET</strong> - Retrieves the most active channels.</p>
<p>Arguments (GET)
:   <strong><em>max</em></strong> (optional) - the maximum number of items to be returned.
:   <strong><em>index</em></strong> (optional) - the index for the first item to be
    returned.</p>
<p>Responses
:   <strong>200 OK</strong> on success.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_get' data-toggle='tab'>JSON GET</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_get'>
		Retrieve the most active channels:</p>
<p>~~~~ bash
GET /most_active
~~~~</p>
<p>~~~~ javascript
200 OK
Content-Type: application/json</p>
<p>{ "items" : [ { "channelType" : "topic",
        "creationDate" : "2012-08-05T14:57:26+0000",
        "defaultAffiliation" : "publisher",
        "description" : "This is an RSS feed from the BBC News - World website.  Original: http://feeds.bbci.co.uk/news/world/rss.xml",
        "jid" : "bbc_news_-_world@topics.buddycloud.org",
        "title" : "BBC News - World"
      },
      { "channelType" : "personal",
        "creationDate" : "2011-10-06T12:02:58+0000",
        "defaultAffiliation" : "publisher",
        "description" : "Flipping you the channel bits. Night and day, the distributed way",
        "jid" : "simon@buddycloud.org",
        "title" : "Simon's chonnel"
      }
    ],
  "rsm" : { "count" : "2",
      "index" : "0"
    }
}
~~~~</p>
	</div>
</div><h2>/account/pw/change</h2>
<p>Description
:   Allows for user password changes.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>POST</strong> - Changes the user's password.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is not provided.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_post'>
		Updates user's password:</p>
<p>~~~~ bash
POST /account/pw/change
Content-Type: application/json</p>
<p>{
  "username": "alice@example.com",
  "password": "newpassword"
}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/account/pw/reset</h2>
<p>Description
:   Allows for user password reset.</p>
<p>Content Types
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>POST</strong> - Resets the user's password.</p>
<p>Responses
:   <strong>200 OK</strong> on success.</p>
<p>Notes
:   When its current password is reset, the user receives an email with
    a new (random) password.</p>
<p>Examples</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_json_post' data-toggle='tab'>JSON POST</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_json_post'>
		Resets user's password:</p>
<p>~~~~ bash
POST /account/pw/reset
Content-Type: application/json</p>
<p>{
  "username": "alice@example.com"
}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div><h2>/account</h2>
<p>Description
:   Creates or deletes an user account.</p>
<p>Attributes
:   <em>username</em> - XMPP username (user@domain or simply user, which will
    use the default domain configured in the API).
:   <em>password</em> - A password for the XMPP account.
:   <em>email</em> - E-mail address to receive push notifications.</p>
<p>Accept
:   JSON <em>(application/json)</em></p>
<p>Methods
:   <strong>POST</strong> - Creates an user account.
:   <strong>DELETE</strong> - Deletes an user account.</p>
<p>Responses
:   <strong>200 OK</strong> on success.
:   <strong>401 Unauthorized</strong> if authentication is required, but not
    provided.</p>
<p>Example</p>
<p><ul class='nav nav-tabs'>
	<li class='active'><a href='#id_post' data-toggle='tab'>POST</a></li>
	<li><a href='#id_delete' data-toggle='tab'>DELETE</a></li>
</ul>
<div class='tab-content'>
	<div class='tab-pane fade in active' id='id_post'>
		Creates an user account</p>
<p>~~~~ bash
POST /account</p>
<p>{
  "username": "alice@shakespeare.lit",
  "password": "pass123",
  "email": "alice@email.com" 
}
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
	<div class='tab-pane fade' id='id_delete'>
		<p>Deletes an user account</p>
<p>~~~~ bash
DELETE /account
~~~~</p>
<p>~~~~ javascript
200 OK
~~~~</p>
	</div>
</div>
	</div>
  </section>
        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://new.buddycloud.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://new.buddycloud.com/theme/js/respond.min.js"></script>
</body>
</html>